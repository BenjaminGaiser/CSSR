---
title: "First Pair Assignment Markdown, Swiss Data Set"
author: "Ben Gaiser & Jeremy Russell"
date: "10/6/2016"
output: html_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## Set global options for viewability
```{r}
options(max.print = 100)
getOption("max.print")
```


## Load packages and remove from global environment
```{r}
packages <- c('repmis', 'knitr', 'rmarkdown', 'Hmisc', 'ggplot2', 'pastecs')
for (p in packages) {
  if (p %in% installed.packages()) require(p, character.only=TRUE) # what does that [] mean
  else {
    install.packages(p)
    require(p, character.only=TRUE)
  }
}
repmis::LoadandCite(packages, file = 'RpackageCitations.bib')
rm(packages, p)
```


## Set working directories and remove from global environment
```{r}
wrkdir <- c('C:/Users/Benji/Desktop/Statistics/Git/Repositories/data/alcohol-consumption', 
            '~/Hertie School/Fall 2016/CollaborativeSocialScienceDataAnalysis/CSSR')
repmis::set_valid_wd(wrkdir)
rm(wrkdir)
```


## Import data frames
```{r}
swiss <- as.data.frame(swiss)
```


## Initial Descriptive Stats
```{r}
summary(swiss$Fertility)
summary(swiss$Education)
describe(swiss$Fertility)
describe(swiss$Education)
var(swiss$Fertility)
var(swiss$Education)
sd(swiss$Fertility)
sd(swiss$Education)
```


## Plot fertility and education with q and barplots. Note: a barplot didn't work with the data for swiss$Fertility. It's basically completely flat.
```{r}
qplot(swiss$Fertility, swiss$Education, xlab = "Fertility", 
      ylab = "Education")
```


## Need to add Swiss canton names to graph below
```{r}
EducationTable <- table(swiss$Education)
barplot(EducationTable, main="Swiss Education Rates",
        xlab="", col=c("red"))
```


## Plot fertility and education with ggplot
```{r}
ggplotRegSwiss <- function(fit){
  ggplot(swiss, aes(Fertility, Education)) +
    geom_point() +
    scale_colour_discrete(name="") +
    stat_smooth(method = "lm", col = "black") +
    labs(title = paste("Adj. R2 = ",signif(summary(fit)$adj.r.squared, 3),
                       "Intercept =" ,signif(fit$coef[[1]],3 ),
                       "Slope =" ,signif(fit$coef[[2]], 1),
                       "P =" ,signif(summary(fit)$coef[2,4], 2)))
}
FitOfDataSwiss <- lm(Fertility ~ Education, data = swiss)
ggplotRegSwiss(FitOfDataSwiss)
```

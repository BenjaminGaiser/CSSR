---
title: "First Pair Assignment Markdown, Alcohol Consumption Data Set"
author: "Ben Gaiser & Jeremy Russell"
date: "October 5, 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Set global options for viewability

```{r}
options(max.print = 100)
getOption("max.print")
```

## Load packages and remove from global environment

```{r}
packages <- c('repmis', 'knitr', 'rmarkdown', 'Hmisc', 'ggplot2', 'pastecs')
for (p in packages) {
  if (p %in% installed.packages()) require(p, character.only=TRUE) # what does that [] mean
  else {
    install.packages(p)
    require(p, character.only=TRUE)
  }
}
repmis::LoadandCite(packages, file = 'RpackageCitations.bib')
rm(packages, p)
```
## Set working directories and remove from global environment

```{r}
wrkdir <- c('C:/Users/Benji/Desktop/Statistics/Git/Repositories/data/alcohol-consumption', 
            '~/Hertie School/Fall 2016/CollaborativeSocialScienceDataAnalysis/CSSR')
repmis::set_valid_wd(wrkdir)
rm(wrkdir)
```

## Import data frames

```{r}
AlcoholConsumption <- read.csv("drinks.csv", header = TRUE, sep = ",", 
                               stringsAsFactors = FALSE, na.strings = c("", "NA"))
```

## Initial Descriptive Statistics
```{r}
summary(AlcoholConsumption)
describe(AlcoholConsumption)
```

## Create heavy wine/spirit drinker categories and use as factor
```{r}
AlcoholConsumption$WineCat1 <- cut(AlcoholConsumption$wine_servings, seq(0, 370, 100))
summary(AlcoholConsumption$WineCat1)
```

## One coloured gradient for wine consumption

```{r}
ggplotRegression <- function(fit){
  ggplot(AlcoholConsumption, aes(beer_servings, total_litres_of_pure_alcohol)) +
    geom_point(aes(colour = factor(AlcoholConsumption$WineCat1))) +
    scale_colour_discrete(name="Wine Servings") +
    stat_smooth(method = "lm", col = "red") +
    labs(title = paste("Adj R2 = ",signif(summary(fit)$adj.r.squared, 3),
                       "Intercept =",signif(fit$coef[[1]],3 ),
                       " Slope =",signif(fit$coef[[2]], 1),
                       " P =",signif(summary(fit)$coef[2,4], 2)))
}
FitOfData <- lm(total_litres_of_pure_alcohol ~ beer_servings, data=AlcoholConsumption)
ggplotRegression(FitOfData)
```

## Who drinks the most and the least amounts of total litres of pure alcohol?
```{r}
which.max(AlcoholConsumption$total_litres_of_pure_alcohol) # row 16
head(AlcoholConsumption[16,]) # Belarus
which.min(AlcoholConsumption$total_litres_of_pure_alcohol) # row 1
head(AlcoholConsumption[1,]) # Afghanistan
```

## Find Germany, USA, South Africa, China and Australia
```{r}
which(grepl("Germany", AlcoholConsumption$country)) # row 66
which(grepl("USA", AlcoholConsumption$country)) # row 185
which(grepl("South Africa", AlcoholConsumption$country)) # row 160
which(grepl("China", AlcoholConsumption$country)) # row 37
which(grepl("Australia", AlcoholConsumption$country)) # row 9
```
## Subset of Five Countries for graphs
```{r}
SubsetOfFiveCountries <- AlcoholConsumption[c(9, 37, 66, 160, 185),]

ggplot(SubsetOfFiveCountries,
       aes(beer_servings, total_litres_of_pure_alcohol)) + 
  geom_point(aes(colour = factor(country))) +
  scale_colour_discrete(name="Countries")
```
